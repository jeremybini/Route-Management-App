<div class="container">
  <div class="row">
    <div class="col-md-12 pull-xs-center">
    <%= link_to "<"+@wall.gym.name, gym_path(@wall.gym), class: "btn btn-primary" %>
    <hr>
    <h2>Wall: <%= @wall.name.capitalize %></h2>
    <% if routesetter %>
      <div class="col-sm-6">
        <div class="pull-xs-center">
          <%= link_to "Add New Routes", new_wall_climb_path(@wall), class: "btn btn-success" %>
          <%= link_to 'Reset Wall', archive_wall_path(@wall), method: :put, data: { confirm: 'Are you sure? This will archive all active routes on this wall.' }, class: "btn btn-warning" %>
        </div>
      </div>
      <span class="visible-xs hidden-sm"><br></span>
      <div class="col-sm-6 pull-sm-right">
        <div class="pull-lg-right pull-md-right pull-sm-right pull-xs-center", style="margin-bottom:5px">
            <%= link_to "Edit Wall Info", edit_wall_path(@wall), class: "btn btn-info" %>
          <% if admin %>
            <%= link_to "Edit Preferred Grade Spread", change_spread_wall_path(@wall), class: "btn btn-primary" %>
          <% end %>
        </div>
      </div>
    <% end %>
    </div>
  </div>
<hr>
  <div class="row">
    <!--check to see if image is present. if not, full width graph. if it is, check for orientation and adjust image and graph div widths to fit -->
    <% if @wall.image.present? %>
      <% if @wall.image_orientation && @wall.image_orientation === "Portrait" %>
        <div id="image_div" class="col-sm-3">
          <div id="wall_display_image" style="background-image: url(<%= @wall.image.url(:large) %>)"></div>
        </div>
        <div id="chart_div" class="col-sm-9">
      <% else %>
        <div id="image_div" class="col-sm-5">
          <div id="wall_display_image" style="background-image: url(<%= @wall.image.url(:large) %>)"></div>
        </div>
        <div id="chart_div" class="col-sm-7">
      <% end %>
    <% else %>
      <div id="chart_div" class="col-md-12">
    <% end %> 
        <div id="chart" style="width: 100%; height:400px;"></div>
      </div>
  </div>
  <hr>
  <div class="climb_sort">
  <h4>Sort by:</h4>
    <%= link_to "Grade", :sort => "grade" %>
    <%= link_to "Setter", :sort => "setter" %>
    <%= link_to "Color", :sort => "color" %>
  <div class="row">
    <% @climbs.each do |climb| %>
      <div class="col-sm-6 col-md-4">
        <div class="panel panel-default">
            <%= link_to climb_path(climb), class: "climb-link" do %>
            <div class="panel-heading clearfix">
              <h4 class="panel-title" style="padding-top: 7.5px;"><%= climb.grade %><span class="pull-right">Rating</span></h4>
            </div>
            <div class="panel-color" style="background-color: <%= tape_color(climb.color) %>;"></div>
            <% end %>
          <div class="panel-body clearfix" style="margin-bottom: 0px; padding: 5px 12.5px">
            <p>Color: <%= climb.color %>
            <% if current_user %>
                <br>
                <%= link_to 'Tick Climb', sends_path(:user_id => current_user.id, :climb_id => climb.id), method: :post, data: { confirm: 'Tick this route?' }, class: "btn btn-default btn-sm pull-right tick-button" %>
            <% end %>
            <p>Setter: <%= climb.setter_name||climb.setter.full_name %></p>
            <p>Date set: <%= climb.created_at.strftime('%D') %></p>
            <% if routesetter %>
              <%= link_to 'Edit Route', edit_climb_path(climb), class: "btn btn-info btn-sm pull-left" %>
              <%= link_to 'Strip Route', archive_climb_path(climb), method: :put, data: { confirm: 'Are you sure? This will archive the route.' }, class: "btn btn-warning btn-sm pull-right" %>
            <% end %>   
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
</div>

<hr>

<div class="container">
  <div class="row">
    <h3>Archived Climbs</h3>
    <% @archived_climbs.each do |climb| %>
      <div class="col-sm-6 col-md-4">
        <div class="panel panel-default" style="border: 1px solid <%= climb.color %>">
          <div class="panel-heading">
            <div class="row">
              <%= link_to climb.grade+" "+climb.color.capitalize, climb %>
            </div>
          </div>
          <div class="panel body">
              <p>Setter: <%= climb.setter_name %></p>
              <p>Type: <%= climb.climb_type %></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
<%= high_chart("chart", @chart) %>

<script>
$(".panel").hover(
  function() {
    var color = $(this).find(".panel-color").css('background-color');
    if (color === 'rgb(0, 0, 0)' || color ==='rgb(6, 18, 197)' || color ==='rgb(102, 0, 153)' || color ==='rgb(210, 10, 10)' || color === 'rgb(6, 99, 18)') {
      $(this).find(".panel-heading").css('background-color', color).css('opacity', '.75').css('color', '#f6f6f6');
    } else {
      $(this).find(".panel-heading").css('background-color', color).css('opacity', '.75').css('color', '#000000')
    };
    $(".panel-heading").mousedown(function() {
      $(this).css('opacity', '1');
      $(this).parent().parent().find('.panel-color').css('opacity', '1');
    });
  },
  function() {
    var color = $(this).find(".panel-color").css('background-color');
    $(this).find(".panel-heading").css('background-color', '#f4f4f4').css('color', '#000000').css('opacity', '1')
    $(this).find(".panel-color").css('opacity', '.75')
});
</script>



